<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>APIverse Explorer</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>üåê APIverse Explorer</h1>
    <p>Discover and use powerful public APIs</p>

    <!-- Submit toggle button -->
    <button id="toggle-form-btn" class="btn-primary">‚ûï Submit an API</button>
  </header>

  <!-- The submit form is hidden by default -->
  <section class="submission-section" id="submission-section" style="display:none;">
    <h2>Submit an API</h2>
    <form id="api-form">
      <input type="text" id="name" placeholder="API Name" required />
      <input type="url" id="url" placeholder="API URL" required />
      <input type="text" id="description" placeholder="Short Description" required />
      <input type="text" id="auth" placeholder="Auth (e.g., No, API Key)" required />
      <input type="text" id="category" placeholder="Category (e.g., Animals)" required />
      <button type="submit">Submit API</button>
    </form>
    <p id="form-message"></p>
  </section>

  <main id="api-container"></main>

  <footer>
    <p>Free. Open Source. Built on GitHub.</p>
  </footer>

  <script src="script.js"></script>

  <script>
    document.getElementById("toggle-form-btn").addEventListener("click", () => {
      const formSection = document.getElementById("submission-section");
      formSection.style.display = formSection.style.display === "none" ? "block" : "none";
    });

    document.getElementById("api-form").addEventListener("submit", async (e) => {
      e.preventDefault();

      const name = document.getElementById("name").value.trim();
      const url = document.getElementById("url").value.trim();
      const description = document.getElementById("description").value.trim();
      const auth = document.getElementById("auth").value.trim();
      const category = document.getElementById("category").value.trim();

      const issueTitle = `New API Submission: ${name}`;
      const issueBody = `
**Name:** ${name}
**URL:** ${url}
**Description:** ${description}
**Auth:** ${auth}
**Category:** ${category}
`;

      const response = await fetch("https://api.github.com/repos/Whiipcream/apiverse/issues", {
        method: "POST",
        headers: {
          "Authorization": "token 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",
          "Accept": "application/vnd.github+json"
        },
        body: JSON.stringify({
          title: issueTitle,
          body: issueBody,
          labels: ["apisubmission"]
        })
      });

      const messageEl = document.getElementById("form-message");

      if (response.ok) {
        messageEl.textContent = "‚úÖ Submission successful! It will be reviewed shortly.";
        messageEl.style.color = "green";
        e.target.reset();
      } else {
        messageEl.textContent = "‚ùå Submission failed. Please try again.";
        messageEl.style.color = "red";
      }
    });
  </script>
</body>
</html>
